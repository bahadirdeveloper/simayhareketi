<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cumhuriyet KatÄ±lÄ±m SayfasÄ± - HALK DEFTERÄ°</title>
  <style>
    body {
      background: url('images/arkaplan.jpg') no-repeat center center fixed;
      background-size: cover;
      color: white;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 2rem;
      text-align: center;
    }
    h1 {
      color: gold;
      margin-bottom: 2rem;
      text-shadow: 0 0 10px black, 0 0 20px gold;
      font-size: 2.2rem;
    }
    form {
      display: flex;
      flex-direction: column;
      width: 100%;
      max-width: 450px;
      background: rgba(0, 0, 0, 0.6);
      padding: 2rem;
      border-radius: 12px;
      border: 2px solid gold;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
      backdrop-filter: blur(5px);
    }
    input, textarea, button {
      margin-bottom: 1rem;
      padding: 0.9rem;
      border: 1px solid gold;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.08);
      color: gold;
      font-size: 1.05rem;
      box-shadow: 0 0 6px rgba(255, 215, 0, 0.2);
      font-weight: bold;
    }
    input::placeholder,
    textarea::placeholder {
      color: #ffd700;
      opacity: 1;
    }
    button {
      background: linear-gradient(45deg, #d4af37, #a30000);
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
      text-shadow: 0 0 8px black;
      font-size: 1.1rem;
    }
    button:hover {
      background: linear-gradient(45deg, #a30000, #d4af37);
      color: white;
    }
    .confirmation {
      margin-top: 1rem;
      color: lime;
      text-align: center;
      font-size: 1.1rem;
      font-weight: bold;
      display: none;
      text-shadow: 0 0 6px black;
    }
  @media (max-width: 600px) {
    body {
      padding: 1rem;
    }
 
    h1 {
      font-size: 1.5rem;
      text-align: center;
    }
 
    form {
      padding: 1.5rem;
      width: 90%;
    }
 
    input, textarea, button {
      font-size: 1rem;
    }
 
    .confirmation {
      font-size: 1rem;
    }
  }
  .odeme-paneli {
    margin-top: 2rem;
    padding: 1.5rem;
    background: rgba(0, 0, 0, 0.5);
    border: 2px dashed gold;
    border-radius: 12px;
    max-width: 450px;
    text-align: center;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
  }

  .odeme-paneli h2 {
    color: gold;
    margin-bottom: 1rem;
  }

  .odeme-paneli p {
    color: #ccc;
    margin-bottom: 1rem;
    font-size: 0.95rem;
  }

  .odeme-paneli button {
    padding: 0.7rem 1.5rem;
    font-size: 1.05rem;
    border: 1px solid gold;
    background: linear-gradient(45deg, #555, #222);
    color: #aaa;
    border-radius: 8px;
    cursor: not-allowed;
    text-shadow: 0 0 5px black;
  }
    /* Mobil uyumluluk iÃ§in geliÅŸmiÅŸ medya sorgularÄ± */
    @media (max-width: 600px) {
      form, .odeme-paneli {
        padding: 1rem !important;
        width: 90% !important;
      }

      input, textarea, button {
        font-size: 1rem !important;
        padding: 0.75rem !important;
        width: 100% !important;
      }

      h1 {
        font-size: 1.6rem !important;
      }

      .odeme-paneli h2 {
        font-size: 1.2rem !important;
      }

      .odeme-paneli p {
        font-size: 0.95rem !important;
      }

      .odeme-paneli button {
        font-size: 1rem !important;
        padding: 0.6rem 1.2rem !important;
      }
    }

    @media (max-width: 375px) {
      h1 {
        font-size: 1.4rem !important;
      }

      input, textarea, button {
        font-size: 0.95rem !important;
      }

      .odeme-paneli h2 {
        font-size: 1.1rem !important;
      }

      .odeme-paneli button {
        font-size: 0.95rem !important;
        padding: 0.5rem 1rem !important;
      }
    }
  .sayaclar {
    margin-top: 2rem;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid gold;
    padding: 1.5rem;
    border-radius: 12px;
    max-width: 450px;
    text-align: left;
    color: gold;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
  }

  .sayaclar h3 {
    text-align: center;
    margin-bottom: 1rem;
    color: gold;
    font-size: 1.3rem;
  }

  .sayaclar ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sayaclar li {
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
  }

  .sayaclar span {
    font-weight: bold;
    color: white;
  }
  .geri-sayim {
    margin-top: 2rem;
    padding: 1rem;
    background: rgba(0, 0, 0, 0.6);
    border: 2px dotted gold;
    border-radius: 10px;
    color: gold;
    max-width: 450px;
    text-align: center;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
  }

  .geri-sayim h3 {
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
    text-shadow: 0 0 6px black;
  }

  .geri-sayim p {
    font-size: 1.1rem;
    font-weight: bold;
    text-shadow: 0 0 5px black;
    color: white;
  }
  </style>
</head>
<body>

  <h1>Halk KatÄ±lÄ±m Formu - Cumhuriyetin 101. YÄ±lÄ± Ä°Ã§in</h1>

  <form id="katilimForm" onsubmit="handleSubmit(event)">
    <input type="text" name="ad" placeholder="AdÄ±nÄ±zÄ± yazÄ±nÄ±z" required />
    <input type="text" name="soyad" placeholder="SoyadÄ±nÄ±zÄ± yazÄ±nÄ±z" required />
    <input type="email" name="email" placeholder="E-posta adresinizi yazÄ±nÄ±z" required />
    <textarea name="mesaj" placeholder="Cumhuriyet iÃ§in halktan bir mesaj bÄ±rakÄ±n..." rows="4"></textarea>
    <button type="submit">KatÄ±ldÄ±m, Belgeyi Al</button>
    <div class="confirmation" id="onayMesaji">KatÄ±lÄ±mÄ±nÄ±z alÄ±nmÄ±ÅŸtÄ±r. TeÅŸekkÃ¼r ederiz!</div>
  </form>

  <div class="geri-sayim">
    <h3>19 MayÄ±s'ta Cumhuriyet GÃ¼ncelleniyor - Kalan SÃ¼re</h3>
    <p id="geriSayimText">HesaplanÄ±yor...</p>
  </div>

  <div class="sayaclar">
    <h3>CanlÄ± SayaÃ§lar</h3>
    <ul>
      <li>KatÄ±lan KiÅŸi SayÄ±sÄ±: <span id="katilimSayisi">0</span></li>
      <li>Tamamlanan Cumhuriyet GÃ¶revi SayÄ±sÄ±: <span id="hayalSayisi">0</span></li>
      <li>TÃ¼rkiye KatÄ±lÄ±m OranÄ±: <span id="oranYuzde">0%</span></li>
    </ul>
  </div>

  <div class="odeme-paneli">
    <h2>1 TL ile Cumhuriyetin 101. yÄ±lÄ±na adÄ±nÄ±zÄ± yazdÄ±rÄ±n</h2>
    <p>Bu sayfa halk tarafÄ±ndan halk iÃ§in aÃ§Ä±lmÄ±ÅŸtÄ±r. Ã–deme sistemi Ã§ok yakÄ±nda aktif edilecektir.</p>
    <button disabled>Ã–deme Yap (SimÃ¼lasyon)</button>
  </div>

  <script>
    // Google Sheets Web App URL (replace with your actual deployed script URL)
    const sheetURL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID_HERE/exec';

    async function handleSubmit(e) {
      e.preventDefault();
      const ad = e.target.ad.value;
      const soyad = e.target.soyad.value;
      const email = e.target.email.value;
      const mesaj = e.target.mesaj.value;

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      // KatÄ±lÄ±m Belgesi BaÅŸlÄ±ÄŸÄ±
      doc.setFont("helvetica", "bold");
      doc.setFontSize(18);
      doc.text("ðŸ“œ 23 Nisan 2025 KatÄ±lÄ±m Belgesi - HALK DEFTERÄ°", 20, 25);

      // AÃ§Ä±klama
      doc.setFontSize(12);
      doc.setFont("helvetica", "normal");
      doc.text("AÅŸaÄŸÄ±da bilgileri yer alan kiÅŸi, HALK DEFTERÄ°'ne resmen katÄ±lmÄ±ÅŸtÄ±r.", 20, 35);
      doc.text("Bu belge, dijital katÄ±lÄ±mÄ±n ve toplumsal sorumluluÄŸun simgesidir.", 20, 42);

      // Bilgi Kutusu Ã‡erÃ§evesi
      doc.setDrawColor(0, 255, 255);
      doc.setLineWidth(0.5);
      doc.rect(15, 50, 180, 90);

      // Kimlik KartÄ± Ä°Ã§eriÄŸi
      doc.setFont("helvetica", "bold");
      doc.setFontSize(14);
      doc.text("ðŸªª 23 Nisan Dijital Kimlik KartÄ±", 20, 60);
      doc.setFont("helvetica", "normal");
      doc.setFontSize(12);
      doc.text(`Ä°sim Soyisim     : ${ad} ${soyad}`, 25, 75);
      doc.text(`E-posta          : ${email}`, 25, 85);
      doc.text(`KatÄ±lÄ±m Tarihi   : ${new Date().toLocaleDateString('tr-TR')}`, 25, 95);
      doc.text(`Kimlik NumarasÄ±  : HALK-${Math.floor(100000 + Math.random() * 900000)}`, 25, 105);

      // Logo ekleme (assets/logo.png dosyasÄ±nÄ± varsayalÄ±m)
      const logo = new Image();
      logo.src = 'assets/logo.png';
      logo.onload = () => {
        doc.addImage(logo, 'PNG', 160, 10, 30, 30); // saÄŸ Ã¼st kÃ¶ÅŸe
        doc.save(`Simay_Katilim_Belgesi_${ad}_${soyad}.pdf`);
      };

      // QR Code
      const qrText = `Ad: ${ad} ${soyad}\\nEmail: ${email}\\nTarih: ${new Date().toLocaleDateString('tr-TR')}`;
      const qrCanvas = document.createElement("canvas");
      const qr = new QRious({
        element: qrCanvas,
        value: qrText,
        size: 100,
        background: '#ffffff',
        foreground: '#000000'
      });
      const imgData = qrCanvas.toDataURL("image/png");
      doc.addImage(imgData, 'PNG', 150, 60, 30, 30);

      // Alt bilgi
      doc.setFontSize(11);
      doc.setTextColor(120);
      doc.text("23 Nisan 2025 Halk Defteri'ne katÄ±ldÄ±ÄŸÄ±nÄ±z iÃ§in teÅŸekkÃ¼r ederiz.", 20, 150);

      // doc.save(...) Ã§aÄŸrÄ±sÄ± logo yÃ¼klenince yapÄ±lacak

      // Google Sheets kayÄ±t
      try {
        await fetch(sheetURL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ad, soyad, email, mesaj })
        });
      } catch (err) {
        console.error('Google Sheet kayÄ±t hatasÄ±:', err);
      }

      document.getElementById("onayMesaji").style.display = "block";
      e.target.reset();
    }

    async function guncelleSayaclarGercek() {
      try {
        const res = await fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID_HERE/exec");
        const data = await res.json();

        const toplam = data.length;
        const gorevli = data.filter(item => item.gorevId && item.gorevId.trim() !== "").length;
        const oran = Math.min(100, (toplam / 10000) * 100); // Ã–rnek: hedef 10.000 kiÅŸi

        document.getElementById("katilimSayisi").textContent = toplam;
        document.getElementById("hayalSayisi").textContent = gorevli;
        document.getElementById("oranYuzde").textContent = oran.toFixed(2) + "%";
      } catch (e) {
        console.error("GerÃ§ek sayaÃ§ verileri alÄ±namadÄ±:", e);
      }
    }

    function guncelleGeriSayim() {
      const hedefTarih = new Date("2025-05-19T00:00:00");
      const simdi = new Date();
      const fark = hedefTarih - simdi;

      if (fark > 0) {
        const gun = Math.floor(fark / (1000 * 60 * 60 * 24));
        const saat = Math.floor((fark / (1000 * 60 * 60)) % 24);
        const dakika = Math.floor((fark / (1000 * 60)) % 60);
        const saniye = Math.floor((fark / 1000) % 60);
        document.getElementById("geriSayimText").textContent =
          `${gun} gÃ¼n ${saat} saat ${dakika} dakika ${saniye} saniye`;
      } else {
        document.getElementById("geriSayimText").textContent = "Sistem AÃ§Ä±ldÄ±!";
      }
    }

    setInterval(guncelleSayaclarGercek, 5000);
    setInterval(guncelleGeriSayim, 1000);
    window.onload = function () {
      guncelleSayaclarGercek();
      guncelleGeriSayim();
    };
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
</body>
</html>
